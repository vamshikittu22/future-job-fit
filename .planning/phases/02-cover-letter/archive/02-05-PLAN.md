---
phase: 02-cover-letter
plan: 05
type: execute
wave: 2
depends_on: ['02-02', '02-03', '02-04']
files_modified:
  - src/features/cover-letter/components/VariantComparison.tsx
  - src/features/cover-letter/components/VariantCard.tsx
  - src/features/cover-letter/components/ATSBadge.tsx
  - src/features/cover-letter/pages/VariantsView.tsx
autonomous: true

must_haves:
  truths:
    - User can view 3 generated cover letter variants
    - Each variant shows ATS score badge
    - Variants displayed in tabbed interface (primary)
    - User can select a variant to edit
    - Variants show tone indicator
    - Word count displayed for each variant
  artifacts:
    - path: "src/features/cover-letter/components/VariantComparison.tsx"
      provides: "Tabbed comparison view for 3 variants"
    - path: "src/features/cover-letter/components/VariantCard.tsx"
      provides: "Individual variant display card"
    - path: "src/features/cover-letter/components/ATSBadge.tsx"
      provides: "ATS score badge component"
    - path: "src/features/cover-letter/pages/VariantsView.tsx"
      provides: "Full variants page with selection"
  key_links:
    - from: "VariantComparison"
      to: "CoverLetterContext"
      via: "Reading variants from context"
---

<objective>
Build multi-variant comparison view for AI-generated cover letters. Users can compare 3 variants side-by-side in tabs, see ATS scores, and select one to edit.

Purpose: Enable users to choose the best cover letter variant after reviewing all options.
Output: Variant comparison UI with tabbed view, ATS badges, and selection flow.
</objective>

<execution_context>
@C:/Users/kittu/.config/opencode/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/phases/02-cover-letter/02-RESEARCH.md

## Multi-Variant UI Pattern

From research:
```typescript
interface VariantTab {
  id: string
  label: string
  content: string
  atsScore: number
  tone: 'formal' | 'conversational' | 'enthusiastic'
}

<Tabs defaultValue="variant-1">
  <TabsList>
    {variants.map(v => (
      <TabsTrigger key={v.id} value={v.id}>
        {v.label} 
        <Badge variant={v.atsScore > 80 ? 'success' : 'warning'}>
          {v.atsScore}%
        </Badge>
      </TabsTrigger>
    ))}
  </TabsList>
  {variants.map(v => (
    <TabsContent key={v.id} value={v.id}>
      <RichTextEditor content={v.content} />
    </TabsContent>
  ))}
</Tabs>
```

## ATS Score Display

- Green badge: 80-100 (Excellent)
- Yellow badge: 60-79 (Good)
- Red badge: Below 60 (Needs work)

## Variant Differentiation

Each variant should differ in:
1. Opening hook style
2. Body paragraph emphasis
3. Closing tone
</context>

<tasks>

<task type="auto">
  <name>Create ATS Badge component</name>
  <files>src/features/cover-letter/components/ATSBadge.tsx</files>
  <action>
    Create ATS score badge component:
    
    1. Component structure:
       - Props: score: number, showLabel?: boolean, size?: 'sm' | 'md' | 'lg'
    
    2. Score categorization:
       - 80-100: Green (success variant), label "Excellent"
       - 60-79: Yellow (warning variant), label "Good"
       - 0-59: Red (destructive variant), label "Needs Work"
    
    3. UI design:
       - Use shadcn Badge component as base
       - Show score as percentage
       - Optional label text
       - Size variants for different contexts
       - Tooltip on hover showing breakdown
    
    4. Accessibility:
       - aria-label: "ATS Score: X%"
       - Color not only indicator (score number always visible)
    
    5. Example usage:
       - Small in tabs: <ATSBadge score={85} size="sm" />
       - Large in detail: <ATSBadge score={85} showLabel size="lg" />
  </action>
  <verify>Component renders with correct colors for score ranges</verify>
  <done>ATSBadge with color-coded scores and size variants</done>
</task>

<task type="auto">
  <name>Create Variant Card component</name>
  <files>src/features/cover-letter/components/VariantCard.tsx</files>
  <action>
    Create individual variant display card:
    
    1. Component structure:
       - Props:
         * variant: CoverLetterVariant
         * isSelected: boolean
         * onSelect: () => void
         * onEdit: () => void
    
    2. Card layout:
       - Header row:
         * Tone badge (Formal/Conversational/Enthusiastic)
         * ATS Badge with score
         * Word count
         * Created timestamp
       
       - Content area:
         * Rendered HTML content
         * Scrollable if long
         * Preview mode (not editable)
       
       - Footer row:
         * "Select & Edit" button (primary)
         * "Preview" button (secondary, expands modal)
    
    3. Selection state:
       - Border highlight when selected
       - Checkmark icon
       - "Selected" label
    
    4. Styling:
       - Use shadcn Card component
       - Consistent spacing
       - Hover effects
       - Responsive layout
    
    5. Content display:
       - Sanitize and render HTML safely
       - Proper typography (use prose classes)
       - Preserve formatting from generation
  </action>
  <verify>Card displays variant content correctly</verify>
  <done>VariantCard with header, content preview, and action buttons</done>
</task>

<task type="auto">
  <name>Create Variant Comparison component</name>
  <files>src/features/cover-letter/components/VariantComparison.tsx</files>
  <action>
    Create tabbed variant comparison view:
    
    1. Component structure:
       - Props:
         * variants: CoverLetterVariant[]
         * selectedId?: string
         * onSelect: (id: string) => void
    
    2. Tab layout (shadcn Tabs):
       - Tab list with 3 tabs:
         * "Variant A" with tone and ATS badge
         * "Variant B" with tone and ATS badge
         * "Variant C" with tone and ATS badge
       - Default to highest ATS score variant
    
    3. Tab content:
       - Each tab shows VariantCard for that variant
       - Read-only preview of content
       - Full formatting preserved
    
    4. Comparison features:
       - Word count comparison across all variants
       - Highlight best ATS score
       - Show tone differences in tab labels
    
    5. Selection flow:
       - "Select This Variant" button in each tab
       - Updates selectedId via onSelect
       - Shows confirmation toast
    
    6. Alternative view toggle:
       - Button to switch to "Side-by-Side" view (stretch goal)
       - Default is tabbed view
    
    7. Empty state:
       - Show if no variants
       - Prompt to generate
  </action>
  <verify>Tabs switch between variants correctly</verify>
  <done>VariantComparison with tabbed interface and selection</done>
</task>

<task type="auto">
  <name>Create Variants View page</name>
  <files>src/features/cover-letter/pages/VariantsView.tsx</files>
  <action>
    Create full variants view page:
    
    1. Component structure:
       - Uses CoverLetterContext to get variants
       - Page layout with header, comparison, actions
    
    2. Page header:
       - Title: "Your Cover Letter Variants"
       - Subtitle: "Choose the version that best represents you"
       - Back button to wizard
    
    3. Main content:
       - VariantComparison component
       - Context about variants (help text)
    
    4. Action bar (sticky bottom):
       - "Edit Selected" button (disabled if none selected)
       - "Generate New Variants" button (regenerates)
       - "Save for Later" button
    
    5. Empty/loading states:
       - Loading skeleton while generating
       - Empty state if no variants
       - Error state if generation failed
    
    6. Selection handling:
       - Update context with selectedVariantId
       - Navigate to edit page on "Edit Selected"
    
    7. Add route in App.tsx:
       - /cover-letter/variants
  </action>
  <verify>Page loads variants and handles selection</verify>
  <done>VariantsView page with full comparison and actions</done>
</task>

</tasks>

<verification>
1. All 3 variants display in tabs
2. ATS badges show correct colors
3. Variant selection updates context
4. Word counts are accurate
5. Tone labels are correct
6. Edit button navigates to editor
</verification>

<success_criteria>
- Tabbed view displays 3 generated variants
- Each variant shows ATS score with color coding
- User can select a variant
- Selection persists and enables edit flow
- UI is responsive and accessible
</success_criteria>

<output>
After completion, create `.planning/phases/02-cover-letter/02-05-SUMMARY.md`
</output>
