---
phase: 00-hardening
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - tsconfig.json
  - src/types/strictness-fixes.d.ts
  - src/shared/types/*.ts
  - package.json (eslint scripts)
autonomous: true

must_haves:
  truths:
    - TypeScript strict mode is enabled
    - Lint errors are reduced to <10
    - "any" types have documented justification or are eliminated
    - Build passes with strict mode enabled
  artifacts:
    - path: "tsconfig.json"
      provides: "Strict TypeScript configuration"
    - path: "src/types/strictness-fixes.d.ts"
      provides: "Gradual strictness migration types"
  key_links:
    - from: "tsconfig.json"
      to: "Build system"
      via: "tsc compiler"
---

<objective>
Enable TypeScript strict mode incrementally to catch runtime errors at compile time. Reduce lint errors from 68+ to under 10.

Purpose: Foundation for ATS engine complexity requires type safety. Phase 1-3 will involve complex NLP and parsing logic that cannot tolerate "any" types.
Output: Strict mode enabled, lint clean, documented type decisions.
</objective>

<execution_context>
@C:/Users/kittu/.config/opencode/get-shit-done/workflows/execute-plan.md
</execution_context>

<context>
@.planning/ROADMAP.md
@tsconfig.json

## Current State
- TypeScript strict mode: Disabled (noImplicitAny: false)
- ESLint errors: 68+ across 18 files
- Known issues: Implicit any types, unchecked index access

## Incremental Strategy
Instead of fixing all 68+ errors at once (would take weeks), we:
1. Enable strict mode with targeted exclusions
2. Fix high-impact files first (shared/, contexts/)
3. Add explicit types to critical paths
4. Document justified "any" usage
5. Set lint threshold to block new errors
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enable Strict Mode with Exclusions</name>
  <files>tsconfig.json</files>
  <action>
    Update tsconfig.json to enable strict mode with targeted exclusions:

    1. Enable these strict flags:
       - "strict": true (enables all strict mode family options)
       - "noUnusedLocals": true
       - "noUnusedParameters": true
       - "exactOptionalPropertyTypes": false (keep false for now - too breaking)

    2. Add exclusions for files with too many errors to fix immediately:
       - Use "exclude" or create tsconfig.strict.json for gradual migration
       - Or use @ts-expect-error comments with justifications

    3. Current tsconfig.json has noImplicitAny: false
       - Change to noImplicitAny: true
       - Add "strictNullChecks": true
       - Add "strictFunctionTypes": true

    4. Document the plan:
       ```json
       {
         "compilerOptions": {
           "strict": true,
           "noImplicitAny": true,
           "strictNullChecks": true,
           "strictFunctionTypes": true,
           "noUnusedLocals": true,
           "noUnusedParameters": true
         },
         "exclude": [
           // Files with too many errors to fix immediately
           // Will be addressed in future PRs
         ]
       }
       ```

    5. Run `npm run build` to identify which files break
    6. Document error count per file
  </action>
  <verify>
    1. Run `npx tsc --noEmit` - count total errors
    2. Run `npm run build` - should complete (may have warnings)
    3. Verify strict flags are in tsconfig.json
  </verify>
  <done>
    Strict mode enabled in tsconfig.json with clear error inventory.
    Build completes, error count documented per file.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix Critical Path Type Errors</name>
  <files>
    src/shared/types/resume.ts
    src/shared/contexts/ResumeContext.tsx
    src/shared/types/job.ts
  </files>
  <action>
    Fix TypeScript errors in critical shared files. Focus on:

    1. ResumeContext.tsx - Known issues:
       - Lines 134, 145: Element implicitly has 'any' type
       - Fix: Add proper type guards for skills object access
       - The error is in skills array/object indexing

    2. Type definition files:
       - src/shared/types/resume.ts
       - src/shared/types/job.ts
       - src/shared/types/coverLetter.ts
       - Add strict types, remove implicit any

    3. Pattern for fixing:
       ```typescript
       // Before (error)
       skills[category].forEach(...)
       
       // After (fixed)
       if (isSkillCategory(skills, category)) {
         skills[category].forEach(...)
       }
       ```

    4. Fix lint errors in these same files
    5. Target: 0 TypeScript errors in shared/ directory
  </action>
  <verify>
    1. Run `npx tsc --noEmit src/shared/**/*.ts`
    2. Verify 0 errors in shared/ directory
    3. Run `npm run lint src/shared/**` - <5 errors
  </verify>
  <done>
    Critical path files (shared/) have zero TypeScript errors.
    Type guards added where needed.
  </done>
</task>

<task type="auto">
  <name>Task 3: Fix High-Traffic Component Errors</name>
  <files>
    src/features/resume-builder/components/**/*.tsx
    src/shared/components/**/*.tsx
  </files>
  <action>
    Fix remaining TypeScript errors in high-traffic components:

    1. Focus on files with highest usage:
       - Editor components
       - Preview components
       - Layout components

    2. Common patterns to fix:
       - Missing return types on functions
       - Implicit any in event handlers
       - Array index access without bounds checking
       - Object property access without type narrowing

    3. For complex cases, use explicit type annotations:
       ```typescript
       // Add explicit types
       const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {
         // implementation
       };
       ```

    4. If a type is genuinely unknown (API response), use:
       ```typescript
       // Documented any with justification
       // eslint-disable-next-line @typescript-eslint/no-explicit-any
       type ApiResponse = any; // Third-party API, no types available
       ```

    5. Track: Files fixed, remaining errors per file
  </action>
  <verify>
    1. Run `npm run lint` - verify error count reduced
    2. Run `npx tsc --noEmit` - verify total error count
    3. Target: <30 total TypeScript errors
  </verify>
  <done>
    High-traffic component TypeScript errors reduced.
    Error count under 30 total across codebase.
  </done>
</task>

<task type="auto">
  <name>Task 4: Lint Cleanup and Enforcement</name>
  <files>
    package.json
    .eslintrc.cjs (or eslint config)
  </files>
  <action>
    Clean up remaining lint errors and enforce quality gates:

    1. Run lint check and categorize remaining errors:
       ```bash
       npm run lint 2>&1 | grep -E "^\s+\d+:\d+" | sort | uniq -c | sort -rn
       ```

    2. Fix common patterns:
       - Unused variables (remove or prefix with _)
       - Console.log statements (remove or use logger)
       - Missing dependencies in useEffect
       - Any types without justification

    3. Update package.json scripts:
       ```json
       {
         "scripts": {
           "lint": "eslint . --ext ts,tsx --report-unused-disable-directives --max-warnings 10",
           "lint:strict": "eslint . --ext ts,tsx --max-warnings 0"
         }
       }
       ```

    4. Add pre-commit hook (optional but recommended):
       - Use lint-staged to run lint on changed files
       - Block commits with >10 warnings

    5. Document any remaining errors that cannot be fixed:
       - Create .eslint-legacy-errors.md with justifications
       - Plan for future cleanup

    6. Target: `npm run lint` returns <10 errors/warnings
  </action>
  <verify>
    1. Run `npm run lint` - verify <10 errors
    2. Run `npm run build` - verify passes
    3. Run `npx tsc --noEmit` - verify no new errors
  </verify>
  <done>
    Lint errors reduced to <10. Build passes. Quality gate enforced.
    Legacy errors documented if any remain.
  </done>
</task>

</tasks>

<verification>
1. TypeScript strict mode enabled in tsconfig.json
2. `npm run lint` returns <10 errors
3. `npm run build` completes successfully
4. Critical path files (shared/) have zero TypeScript errors
5. Error inventory documented for future cleanup
</verification>

<success_criteria>
- TypeScript strict mode enabled
- Lint errors under 10
- Build passes without errors
- Critical shared files type-safe
- Quality gates in place to prevent regression
</success_criteria>

<output>
After completion, create `.planning/phases/00-hardening/00-01-SUMMARY.md`
</output>
